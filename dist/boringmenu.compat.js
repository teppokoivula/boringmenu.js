!function(){"use strict";if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw Error("Could not prevent default")}catch(e){var t=function(e,t){var n,s;return(t=t||{}).bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),s=n.preventDefault,n.preventDefault=function(){s.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n};t.prototype=window.Event.prototype,window.CustomEvent=t}try{document.querySelector(":scope *")}catch(e){!function(e){var t=/:scope(?![\w-])/gi,n=l(e.querySelector);e.querySelector=function(e){return n.apply(this,arguments)};var s=l(e.querySelectorAll);if(e.querySelectorAll=function(e){return s.apply(this,arguments)},e.matches){var i=l(e.matches);e.matches=function(e){return i.apply(this,arguments)}}if(e.closest){var o=l(e.closest);e.closest=function(e){return o.apply(this,arguments)}}function l(e){return function(n){if(!(n&&t.test(n)))return e.apply(this,arguments);var s="q"+Math.floor(9e6*Math.random())+"1000000";arguments[0]=n.replace(t,"["+s+"]"),this.setAttribute(s,"");var i=e.apply(this,arguments);return this.removeAttribute(s),i}}}(Element.prototype)}window.boringmenu=class{constructor(e={}){if(this.defaultOptions={selectors:{menu:".boringmenu",item:":scope > li"},classes:{item:"boringmenu__item",itemActive:"boringmenu__item--active",itemParent:"boringmenu__item--parent",toggle:"boringmenu__toggle",toggleTextContainer:"boringmenu__sr-only",hidden:""},labels:{"menu.open":"Open","menu.close":"Close"},icons:{"menu.open":"fas fa-plus","menu.close":"fas fa-times"},id:"boringmenu-"+this.getID(),mode:"default",path:""},this.polyfills(),this.options=this.mergeOptions(e),this.options.classes&&Object.keys(this.options.classes).forEach(e=>{"string"==typeof this.options.classes[e]?this.options.classes[e]=this.options.classes[e].split(" "):Array.isArray(this.options.classes[e])||(this.options.classes[e]=[])}),this.menu=document.querySelector(this.options.selectors.menu),!this.menu)return void document.dispatchEvent(new CustomEvent("boringmenu-init-done"));if(this.menu.setAttribute("data-boringmenu-depth",1),this.menuNum=0,this.menuObjects=[this.menu],this.menu.getAttribute("data-boringmenu"))try{this.options=this.mergeOptions(JSON.parse(this.menu.getAttribute("data-boringmenu"),this.options))}catch(e){}this.addClasses(this.menu,this.options.classes),this.findSubMenus(this.menu),this.menu.dispatchEvent(new CustomEvent("boringmenu-init-done",{bubbles:!0,cancelable:!0}))}addClasses(e,t){let n=this.options.path||window.location.pathname.replace(/\/$/,"")+"/",s=t.item.map(e=>"."+e+'[href="'+n+'"]');e.querySelectorAll(s.join(", ")).forEach(e=>{for(e.classList.add(...t.itemActive),e=e.parentNode;e.parentNode;)if("LI"==(e=e.parentNode).tagName){let n=e.firstElementChild;null!==n&&this.hasClass(n,t.item)&&!this.hasClass(n,t.itemActive)&&n.classList.add(...t.itemParent)}else if(e.matches(this.options.selectors.menu))break})}findSubMenus(e,t=2){e.querySelectorAll(this.options.selectors.item).forEach(e=>{let n=e.querySelector("ul");n&&(this.menuNum++,n.setAttribute("id",this.options.id+"-"+this.menuNum),n.setAttribute("data-boringmenu-depth",t),this.hasClass(e,this.options.classes.itemActive)||e.querySelector("."+this.options.classes.itemActive)||this.setHidden(n,!0),n.parentNode.insertBefore(this.getToggle(n),n),this.menuObjects.push(n),this.findSubMenus(n,t+1))})}toggleMenu(e,t,n,s,i,o=!0,l=!1){this.setHidden(e,i),e.menuToggleIcon=e.menuToggleIcon||null,t.setAttribute("aria-expanded",!this.isHidden(e)),n.nodeValue=this.options.labels[this.isHidden(e)?"menu.open":"menu.close"],null!=s&&(e.menuToggleIcon=this.getToggleIcon(e),s.parentNode.replaceChild(e.menuToggleIcon,s)),l||"accordion"!==this.options.mode||this.menuObjects.forEach(t=>{!(t.id===e.id||this.isHidden(t)||t.contains(e))&&t.menuToggle&&this.toggleMenu(t,t.menuToggle,t.menuToggleText,t.menuToggleIcon,!0,!0,!0)}),o&&this.menu.dispatchEvent(new CustomEvent("boringmenu-menu-toggle-done",{bubbles:!0,cancelable:!0,detail:{menu:e,menuDepth:e.getAttribute("data-boringmenu-depth")}}))}getToggle(e){let t=document.createElement("button");t.classList.add(...this.options.classes.toggle),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded",!this.isHidden(e)),t.setAttribute("aria-controls",e.getAttribute("id"));let n=document.createElement("span");this.options.classes.toggleTextContainer&&n.classList.add(...this.options.classes.toggleTextContainer),t.appendChild(n);let s=document.createTextNode(this.options.labels[this.isHidden(e)?"menu.open":"menu.close"]);n.appendChild(s);let i=this.getToggleIcon(e);return null!=i&&t.appendChild(i),e.menuToggle=t,e.menuToggleText=s,e.menuToggleIcon=i,t.addEventListener("click",t=>{t.stopPropagation(),this.toggleMenu(e,e.menuToggle,e.menuToggleText,e.menuToggleIcon,!this.isHidden(e))}),t.addEventListener("keydown",t=>{let n;[40,38,13,32].indexOf(t.keyCode)>-1&&(t.preventDefault(),n=40!==t.keyCode&&(38===t.keyCode||!this.isHidden(e)),this.toggleMenu(e,e.menuToggle,e.menuToggleText,e.menuToggleIcon,n))}),t}getToggleIcon(e,t){if(t=t||null,this.options.icons["menu.open"]&&this.options.icons["menu.close"])if("string"==typeof(t=this.options.icons[this.isHidden(e)?"menu.open":"menu.close"])){let e=t;(t=document.createElement("i")).setAttribute("aria-hidden",!0),t.classList.add(...e.split(" "))}else Array.isArray(t)?((t=document.createElement("i")).setAttribute("aria-hidden",!0),t.classList.add(...t)):"object"==typeof t&&"function"==typeof t.cloneNode?t=t.cloneNode(!0):"function"==typeof t&&(t=t(e,e.getAttribute("data-boringmenu-depth")));return t}mergeOptions(e,t,n=1){null==t&&(t=this.defaultOptions);let s=Object.keys(e);if(!s.length)return t;for(let i=0;i<s.length;i++){let o=s[i];null!==t[o]&&("object"==typeof t[o]?Object.assign(e[o],this.mergeOptions(t[o],e[o],n+1)):1===n&&(t[o]=e[o]))}return Object.assign(e||{},t),e}getID(){return Date.now()}getMenu(){return this.menu}getMenuObjects(){return this.menuObjects}isHidden(e){return this.options.classes.hidden&&this.hasClass(e,this.options.classes.hidden)||e.hidden}setHidden(e,t){this.options.classes.hidden.length&&(t?e.classList.add(...this.options.classes.hidden):e.classList.remove(...this.options.classes.hidden)),e.hidden=t}hasClass(e,t){if(!e||!t||Array.isArray(t)&&!t.length)return!1;if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(e.classList.contains(t[n]))return!0}else if(e.classList.contains(t))return!0;return!1}polyfills(){"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(let n=0;n<this.length;n++)e.call(t,this[n],n,this)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw TypeError("Cannot convert undefined or null to object");let n=Object(e);for(let e=1;e<arguments.length;e++){let t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},writable:!0,configurable:!0})}}}();
//# sourceMappingURL=boringmenu.compat.js.map
