!function(){"use strict";window.boringmenu=class{constructor(e={}){if(this.defaultOptions={selectors:{menu:".boringmenu",item:":scope > li"},classes:{item:"boringmenu__item",itemActive:"boringmenu__item--active",itemParent:"boringmenu__item--parent",toggle:"boringmenu__toggle",toggleTextContainer:"boringmenu__sr-only",hidden:""},labels:{"menu.open":"Open","menu.close":"Close"},icons:{"menu.open":"fas fa-plus","menu.close":"fas fa-times"},id:"boringmenu-"+this.getID(),mode:"default",path:""},this.polyfills(),this.options=this.mergeOptions(e),this.options.classes&&Object.keys(this.options.classes).forEach(e=>{"string"==typeof this.options.classes[e]?this.options.classes[e]=this.options.classes[e].split(" ").filter(e=>""!==e.trim()):Array.isArray(this.options.classes[e])||(this.options.classes[e]=[])}),this.menu=document.querySelector(this.options.selectors.menu),!this.menu)return void document.dispatchEvent(new CustomEvent("boringmenu-init-done"));if(this.menu.setAttribute("data-boringmenu-depth",1),this.menuNum=0,this.menuObjects=[this.menu],this.menu.getAttribute("data-boringmenu"))try{this.options=this.mergeOptions(JSON.parse(this.menu.getAttribute("data-boringmenu"),this.options))}catch(e){}this.addClasses(this.menu,this.options.classes),this.findSubMenus(this.menu),this.menu.dispatchEvent(new CustomEvent("boringmenu-init-done",{bubbles:!0,cancelable:!0}))}addClasses(e,t){let s=this.options.path||window.location.pathname.replace(/\/$/,"")+"/",n=t.item.map(e=>"."+e+'[href="'+s+'"]');e.querySelectorAll(n.join(", ")).forEach(e=>{for(e.classList.add(...t.itemActive),e=e.parentNode;e.parentNode;)if("LI"==(e=e.parentNode).tagName){let s=e.firstElementChild;null!==s&&this.hasClass(s,t.item)&&!this.hasClass(s,t.itemActive)&&s.classList.add(...t.itemParent)}else if(e.matches(this.options.selectors.menu))break})}findSubMenus(e,t=2){e.querySelectorAll(this.options.selectors.item).forEach(e=>{let s=e.querySelector("ul");s&&(this.menuNum++,s.setAttribute("id",this.options.id+"-"+this.menuNum),s.setAttribute("data-boringmenu-depth",t),this.hasClass(e,this.options.classes.itemActive)||e.querySelector("."+this.options.classes.itemActive)||this.setHidden(s,!0),s.parentNode.insertBefore(this.getToggle(s),s),this.menuObjects.push(s),this.findSubMenus(s,t+1))})}toggleMenu(e,t,s,n,i,o=!0,l=!1){this.setHidden(e,i),e.menuToggleIcon=e.menuToggleIcon||null,t.setAttribute("aria-expanded",!this.isHidden(e)),s.nodeValue=this.options.labels[this.isHidden(e)?"menu.open":"menu.close"],null!=n&&(e.menuToggleIcon=this.getToggleIcon(e),n.parentNode.replaceChild(e.menuToggleIcon,n)),l||"accordion"!==this.options.mode||this.menuObjects.forEach(t=>{!(t.id===e.id||this.isHidden(t)||t.contains(e))&&t.menuToggle&&this.toggleMenu(t,t.menuToggle,t.menuToggleText,t.menuToggleIcon,!0,!0,!0)}),o&&this.menu.dispatchEvent(new CustomEvent("boringmenu-menu-toggle-done",{bubbles:!0,cancelable:!0,detail:{menu:e,menuDepth:e.getAttribute("data-boringmenu-depth")}}))}getToggle(e){let t=document.createElement("button");t.classList.add(...this.options.classes.toggle),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded",!this.isHidden(e)),t.setAttribute("aria-controls",e.getAttribute("id"));let s=document.createElement("span");this.options.classes.toggleTextContainer&&s.classList.add(...this.options.classes.toggleTextContainer),t.appendChild(s);let n=document.createTextNode(this.options.labels[this.isHidden(e)?"menu.open":"menu.close"]);s.appendChild(n);let i=this.getToggleIcon(e);return null!=i&&t.appendChild(i),e.menuToggle=t,e.menuToggleText=n,e.menuToggleIcon=i,t.addEventListener("click",t=>{t.stopPropagation(),this.toggleMenu(e,e.menuToggle,e.menuToggleText,e.menuToggleIcon,!this.isHidden(e))}),t.addEventListener("keydown",t=>{let s;[40,38,13,32].indexOf(t.keyCode)>-1&&(t.preventDefault(),s=40!==t.keyCode&&(38===t.keyCode||!this.isHidden(e)),this.toggleMenu(e,e.menuToggle,e.menuToggleText,e.menuToggleIcon,s))}),t}getToggleIcon(e,t){if(t=t||null,this.options.icons["menu.open"]&&this.options.icons["menu.close"])if("string"==typeof(t=this.options.icons[this.isHidden(e)?"menu.open":"menu.close"])){let e=t;(t=document.createElement("i")).setAttribute("aria-hidden",!0),t.classList.add(...e.split(" "))}else Array.isArray(t)?((t=document.createElement("i")).setAttribute("aria-hidden",!0),t.classList.add(...t)):"object"==typeof t&&"function"==typeof t.cloneNode?t=t.cloneNode(!0):"function"==typeof t&&(t=t(e,e.getAttribute("data-boringmenu-depth")));return t}mergeOptions(e,t,s=1){null==t&&(t=this.defaultOptions);let n=Object.keys(e);if(!n.length)return t;for(let i=0;i<n.length;i++){let o=n[i];null!==t[o]&&("object"==typeof t[o]?Object.assign(e[o],this.mergeOptions(t[o],e[o],s+1)):1===s&&(t[o]=e[o]))}return Object.assign(e||{},t),e}getID(){return Date.now()}getMenu(){return this.menu}getMenuObjects(){return this.menuObjects}isHidden(e){return this.options.classes.hidden&&this.hasClass(e,this.options.classes.hidden)||e.hidden}setHidden(e,t){this.options.classes.hidden.length&&(t?e.classList.add(...this.options.classes.hidden):e.classList.remove(...this.options.classes.hidden)),e.hidden=t}hasClass(e,t){if(!e||!t||Array.isArray(t)&&!t.length)return!1;if(Array.isArray(t)){for(let s=0;s<t.length;s++)if(e.classList.contains(t[s]))return!0}else if(e.classList.contains(t))return!0;return!1}polyfills(){"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(let s=0;s<this.length;s++)e.call(t,this[s],s,this)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw TypeError("Cannot convert undefined or null to object");let s=Object(e);for(let e=1;e<arguments.length;e++){let t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=t[e])}return s},writable:!0,configurable:!0})}}}();
//# sourceMappingURL=boringmenu.min.js.map
